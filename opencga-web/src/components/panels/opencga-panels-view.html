<!--
  ~ Copyright 2015-2016 OpenCB
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->
<link rel="import" href="opencga-panels-info-variants.html">
<link rel="import" href="opencga-panels-info-regions.html">

<dom-module id="opencga-panels-view">
    <template>
        <style is="custom-style" include="jso-styles"></style>

        <div style="padding: 10px;">

            <div>
                <span style="font-weight: bold ">Name: </span><span>{{_panel.name}}</span> <br>
                <span style="font-weight: bold ">Disease: </span><span>{{_panel.disease}}</span> <br>
                <span style="font-weight: bold ">Description: </span><span>{{_panel.description}}</span> <br>
                <span style="font-weight: bold ">Date: </span><span>{{_panel.status.date}}</span>
            </div>

            <div class="row" style="height: 530px">
                <ul id="myTabs" class="nav nav-tabs" role="tablist">
                    <li role="presentation" class="active"><a href="#genesViewInfo" role="tab" data-toggle="tab">Genes</a></li>
                    <li role="presentation"><a href="#regionsViewInfo" role="tab" data-toggle="tab">Regions</a></li>
                    <li role="presentation"><a href="#variantsViewInfo" role="tab" data-toggle="tab">Variants</a></li>
                </ul>

                <div class="tab-content">
                    <div id="genesViewInfo" role="tabpanel" class="tab-pane  active">
                        <opencga-panels-info-regions idd="geneTable" data="{{genes}}"></opencga-panels-info-regions>
                    </div>

                    <div id="regionsViewInfo" role="tabpanel" class="tab-pane">
                        <opencga-panels-info-regions idd="regionTable" data="{{regions}}"></opencga-panels-info-regions>
                    </div>

                    <div id="variantsViewInfo" role="tabpanel" class="tab-pane">
                        <opencga-panels-info-variants data="{{variants}}"></opencga-panels-info-variants>
                    </div>
                </div>
            </div>


        </div>

    </template>
    <script>
        Polymer({
            is: 'opencga-panels-view',

            properties: {
                opencgaClient: {
                    type: Object,
                    observer: "callPanel"
                },
                variants: {
                    type: Array
                }
            },

            ready: function() {
//                this.opencgaClient.panels().info(3553).then(function(response) {
//                    debugger
//                    _this.$.opencgaUser.value = "";
//                    _this.$.opencgaPassword.value = "";
//                    _this.$.incorrect.hidden = true;
//                    _this.fire('login', {
//                        userId: user,
//                        sessionId: response.response[0].result[0].sessionId
//                    });
//                }).catch(function(response) {
//                    debugger
//                    this.errorMessage = response.error;
//                    this.$.incorrect.hidden = false;
//                }.bind(this));
            },
            callPanel: function() {
                var me = this;
//                this.opencgaClient.panels().info(3553).then(function(response) {
//                    me._panel = response.response[0].result[0];
//                    me._panel.status.date
//
//                    me.variants = [];
//                    let allVariants = me._panel.variants;
//                    for (let i = 0; i < allVariants.length; i++) {
//                        let variant = allVariants[i].split(":");
//                        me.push("variants", {
//                            "chr": variant[0],
//                            "pos": variant[1],
//                            "ref": variant[2],
//                            "alt": variant[3]
//                        });
//                    }
//
//                    me.regions = [];
//                    let allRegions = me._panel.regions;
//                    for (let i = 0; i < allRegions.length; i++) {
//                        let first = allRegions[i].split(":");
//                        let pos;
//                        if (first.length == 1) {
//                            pos = ["", ""];
//                        } else {
//                            let tmp = first[1].split("-");
//                            if (tmp.length == 1) {
//                                pos = [first[1], first[1]];
//                            } else {
//                                pos = [tmp[0], tmp[1]];
//                            }
//                        }
//                        me.push("regions", {
//                            "name": allRegions[i],
//                            "chr": first[0],
//                            "start": pos[0],
//                            "end": pos[1]
//                        });
//                    }
//
//                    me.genes = [];
//                    let allGenes = me._panel.genes;
//                    for (let i = 0; i < allGenes.length; i++) {
//                        me.push("genes", {
//                            "name": allGenes[i],
//                            "chr": "",
//                            "start": "",
//                            "end": ""
//                        });
//                    }
//                }).catch(function(response) {
//                    console.log(response.error);
//                });
            }
        });
    </script>
</dom-module>
